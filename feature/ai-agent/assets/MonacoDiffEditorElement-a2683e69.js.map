{"version":3,"file":"MonacoDiffEditorElement-a2683e69.js","sources":["../../node_modules/@tanstack/query-core/build/lib/mutation.mjs","../../node_modules/@tanstack/query-core/build/lib/mutationObserver.mjs","../../node_modules/@tanstack/react-query/build/lib/useMutation.mjs","../../packages/shared/src/components/MonacoDiffEditor/useRevert.ts","../../packages/shared/src/components/MonacoDiffEditor/useAddLineControls.tsx","../../packages/shared/src/components/MonacoDiffEditor/useMonacoDiffEditorElement.ts","../../packages/shared/src/components/MonacoDiffEditor/MonacoDiffEditorElement.tsx"],"sourcesContent":["import { defaultLogger } from './logger.mjs';\nimport { notifyManager } from './notifyManager.mjs';\nimport { Removable } from './removable.mjs';\nimport { createRetryer, canFetch } from './retryer.mjs';\n\n// CLASS\nclass Mutation extends Removable {\n  constructor(config) {\n    super();\n    this.options = { ...config.defaultOptions,\n      ...config.options\n    };\n    this.mutationId = config.mutationId;\n    this.mutationCache = config.mutationCache;\n    this.logger = config.logger || defaultLogger;\n    this.observers = [];\n    this.state = config.state || getDefaultState();\n    this.updateCacheTime(this.options.cacheTime);\n    this.scheduleGc();\n  }\n\n  get meta() {\n    return this.options.meta;\n  }\n\n  setState(state) {\n    this.dispatch({\n      type: 'setState',\n      state\n    });\n  }\n\n  addObserver(observer) {\n    if (this.observers.indexOf(observer) === -1) {\n      this.observers.push(observer); // Stop the mutation from being garbage collected\n\n      this.clearGcTimeout();\n      this.mutationCache.notify({\n        type: 'observerAdded',\n        mutation: this,\n        observer\n      });\n    }\n  }\n\n  removeObserver(observer) {\n    this.observers = this.observers.filter(x => x !== observer);\n    this.scheduleGc();\n    this.mutationCache.notify({\n      type: 'observerRemoved',\n      mutation: this,\n      observer\n    });\n  }\n\n  optionalRemove() {\n    if (!this.observers.length) {\n      if (this.state.status === 'loading') {\n        this.scheduleGc();\n      } else {\n        this.mutationCache.remove(this);\n      }\n    }\n  }\n\n  continue() {\n    var _this$retryer$continu, _this$retryer;\n\n    return (_this$retryer$continu = (_this$retryer = this.retryer) == null ? void 0 : _this$retryer.continue()) != null ? _this$retryer$continu : this.execute();\n  }\n\n  async execute() {\n    const executeMutation = () => {\n      var _this$options$retry;\n\n      this.retryer = createRetryer({\n        fn: () => {\n          if (!this.options.mutationFn) {\n            return Promise.reject('No mutationFn found');\n          }\n\n          return this.options.mutationFn(this.state.variables);\n        },\n        onFail: (failureCount, error) => {\n          this.dispatch({\n            type: 'failed',\n            failureCount,\n            error\n          });\n        },\n        onPause: () => {\n          this.dispatch({\n            type: 'pause'\n          });\n        },\n        onContinue: () => {\n          this.dispatch({\n            type: 'continue'\n          });\n        },\n        retry: (_this$options$retry = this.options.retry) != null ? _this$options$retry : 0,\n        retryDelay: this.options.retryDelay,\n        networkMode: this.options.networkMode\n      });\n      return this.retryer.promise;\n    };\n\n    const restored = this.state.status === 'loading';\n\n    try {\n      var _this$mutationCache$c3, _this$mutationCache$c4, _this$options$onSucce, _this$options2, _this$options$onSettl, _this$options3;\n\n      if (!restored) {\n        var _this$mutationCache$c, _this$mutationCache$c2, _this$options$onMutat, _this$options;\n\n        this.dispatch({\n          type: 'loading',\n          variables: this.options.variables\n        }); // Notify cache callback\n\n        await ((_this$mutationCache$c = (_this$mutationCache$c2 = this.mutationCache.config).onMutate) == null ? void 0 : _this$mutationCache$c.call(_this$mutationCache$c2, this.state.variables, this));\n        const context = await ((_this$options$onMutat = (_this$options = this.options).onMutate) == null ? void 0 : _this$options$onMutat.call(_this$options, this.state.variables));\n\n        if (context !== this.state.context) {\n          this.dispatch({\n            type: 'loading',\n            context,\n            variables: this.state.variables\n          });\n        }\n      }\n\n      const data = await executeMutation(); // Notify cache callback\n\n      await ((_this$mutationCache$c3 = (_this$mutationCache$c4 = this.mutationCache.config).onSuccess) == null ? void 0 : _this$mutationCache$c3.call(_this$mutationCache$c4, data, this.state.variables, this.state.context, this));\n      await ((_this$options$onSucce = (_this$options2 = this.options).onSuccess) == null ? void 0 : _this$options$onSucce.call(_this$options2, data, this.state.variables, this.state.context));\n      await ((_this$options$onSettl = (_this$options3 = this.options).onSettled) == null ? void 0 : _this$options$onSettl.call(_this$options3, data, null, this.state.variables, this.state.context));\n      this.dispatch({\n        type: 'success',\n        data\n      });\n      return data;\n    } catch (error) {\n      try {\n        var _this$mutationCache$c5, _this$mutationCache$c6, _this$options$onError, _this$options4, _this$options$onSettl2, _this$options5;\n\n        // Notify cache callback\n        await ((_this$mutationCache$c5 = (_this$mutationCache$c6 = this.mutationCache.config).onError) == null ? void 0 : _this$mutationCache$c5.call(_this$mutationCache$c6, error, this.state.variables, this.state.context, this));\n\n        if (process.env.NODE_ENV !== 'production') {\n          this.logger.error(error);\n        }\n\n        await ((_this$options$onError = (_this$options4 = this.options).onError) == null ? void 0 : _this$options$onError.call(_this$options4, error, this.state.variables, this.state.context));\n        await ((_this$options$onSettl2 = (_this$options5 = this.options).onSettled) == null ? void 0 : _this$options$onSettl2.call(_this$options5, undefined, error, this.state.variables, this.state.context));\n        throw error;\n      } finally {\n        this.dispatch({\n          type: 'error',\n          error: error\n        });\n      }\n    }\n  }\n\n  dispatch(action) {\n    const reducer = state => {\n      switch (action.type) {\n        case 'failed':\n          return { ...state,\n            failureCount: action.failureCount,\n            failureReason: action.error\n          };\n\n        case 'pause':\n          return { ...state,\n            isPaused: true\n          };\n\n        case 'continue':\n          return { ...state,\n            isPaused: false\n          };\n\n        case 'loading':\n          return { ...state,\n            context: action.context,\n            data: undefined,\n            failureCount: 0,\n            failureReason: null,\n            error: null,\n            isPaused: !canFetch(this.options.networkMode),\n            status: 'loading',\n            variables: action.variables\n          };\n\n        case 'success':\n          return { ...state,\n            data: action.data,\n            failureCount: 0,\n            failureReason: null,\n            error: null,\n            status: 'success',\n            isPaused: false\n          };\n\n        case 'error':\n          return { ...state,\n            data: undefined,\n            error: action.error,\n            failureCount: state.failureCount + 1,\n            failureReason: action.error,\n            isPaused: false,\n            status: 'error'\n          };\n\n        case 'setState':\n          return { ...state,\n            ...action.state\n          };\n      }\n    };\n\n    this.state = reducer(this.state);\n    notifyManager.batch(() => {\n      this.observers.forEach(observer => {\n        observer.onMutationUpdate(action);\n      });\n      this.mutationCache.notify({\n        mutation: this,\n        type: 'updated',\n        action\n      });\n    });\n  }\n\n}\nfunction getDefaultState() {\n  return {\n    context: undefined,\n    data: undefined,\n    error: null,\n    failureCount: 0,\n    failureReason: null,\n    isPaused: false,\n    status: 'idle',\n    variables: undefined\n  };\n}\n\nexport { Mutation, getDefaultState };\n//# sourceMappingURL=mutation.mjs.map\n","import { getDefaultState } from './mutation.mjs';\nimport { notifyManager } from './notifyManager.mjs';\nimport { Subscribable } from './subscribable.mjs';\nimport { shallowEqualObjects } from './utils.mjs';\n\n// CLASS\nclass MutationObserver extends Subscribable {\n  constructor(client, options) {\n    super();\n    this.client = client;\n    this.setOptions(options);\n    this.bindMethods();\n    this.updateResult();\n  }\n\n  bindMethods() {\n    this.mutate = this.mutate.bind(this);\n    this.reset = this.reset.bind(this);\n  }\n\n  setOptions(options) {\n    const prevOptions = this.options;\n    this.options = this.client.defaultMutationOptions(options);\n\n    if (!shallowEqualObjects(prevOptions, this.options)) {\n      this.client.getMutationCache().notify({\n        type: 'observerOptionsUpdated',\n        mutation: this.currentMutation,\n        observer: this\n      });\n    }\n  }\n\n  onUnsubscribe() {\n    if (!this.listeners.length) {\n      var _this$currentMutation;\n\n      (_this$currentMutation = this.currentMutation) == null ? void 0 : _this$currentMutation.removeObserver(this);\n    }\n  }\n\n  onMutationUpdate(action) {\n    this.updateResult(); // Determine which callbacks to trigger\n\n    const notifyOptions = {\n      listeners: true\n    };\n\n    if (action.type === 'success') {\n      notifyOptions.onSuccess = true;\n    } else if (action.type === 'error') {\n      notifyOptions.onError = true;\n    }\n\n    this.notify(notifyOptions);\n  }\n\n  getCurrentResult() {\n    return this.currentResult;\n  }\n\n  reset() {\n    this.currentMutation = undefined;\n    this.updateResult();\n    this.notify({\n      listeners: true\n    });\n  }\n\n  mutate(variables, options) {\n    this.mutateOptions = options;\n\n    if (this.currentMutation) {\n      this.currentMutation.removeObserver(this);\n    }\n\n    this.currentMutation = this.client.getMutationCache().build(this.client, { ...this.options,\n      variables: typeof variables !== 'undefined' ? variables : this.options.variables\n    });\n    this.currentMutation.addObserver(this);\n    return this.currentMutation.execute();\n  }\n\n  updateResult() {\n    const state = this.currentMutation ? this.currentMutation.state : getDefaultState();\n    const result = { ...state,\n      isLoading: state.status === 'loading',\n      isSuccess: state.status === 'success',\n      isError: state.status === 'error',\n      isIdle: state.status === 'idle',\n      mutate: this.mutate,\n      reset: this.reset\n    };\n    this.currentResult = result;\n  }\n\n  notify(options) {\n    notifyManager.batch(() => {\n      // First trigger the mutate callbacks\n      if (this.mutateOptions && this.hasListeners()) {\n        if (options.onSuccess) {\n          var _this$mutateOptions$o, _this$mutateOptions, _this$mutateOptions$o2, _this$mutateOptions2;\n\n          (_this$mutateOptions$o = (_this$mutateOptions = this.mutateOptions).onSuccess) == null ? void 0 : _this$mutateOptions$o.call(_this$mutateOptions, this.currentResult.data, this.currentResult.variables, this.currentResult.context);\n          (_this$mutateOptions$o2 = (_this$mutateOptions2 = this.mutateOptions).onSettled) == null ? void 0 : _this$mutateOptions$o2.call(_this$mutateOptions2, this.currentResult.data, null, this.currentResult.variables, this.currentResult.context);\n        } else if (options.onError) {\n          var _this$mutateOptions$o3, _this$mutateOptions3, _this$mutateOptions$o4, _this$mutateOptions4;\n\n          (_this$mutateOptions$o3 = (_this$mutateOptions3 = this.mutateOptions).onError) == null ? void 0 : _this$mutateOptions$o3.call(_this$mutateOptions3, this.currentResult.error, this.currentResult.variables, this.currentResult.context);\n          (_this$mutateOptions$o4 = (_this$mutateOptions4 = this.mutateOptions).onSettled) == null ? void 0 : _this$mutateOptions$o4.call(_this$mutateOptions4, undefined, this.currentResult.error, this.currentResult.variables, this.currentResult.context);\n        }\n      } // Then trigger the listeners\n\n\n      if (options.listeners) {\n        this.listeners.forEach(listener => {\n          listener(this.currentResult);\n        });\n      }\n    });\n  }\n\n}\n\nexport { MutationObserver };\n//# sourceMappingURL=mutationObserver.mjs.map\n","import * as React from 'react';\nimport { useSyncExternalStore } from './useSyncExternalStore.mjs';\nimport { parseMutationArgs, MutationObserver, notifyManager } from '@tanstack/query-core';\nimport { useQueryClient } from './QueryClientProvider.mjs';\nimport { shouldThrowError } from './utils.mjs';\n\nfunction useMutation(arg1, arg2, arg3) {\n  const options = parseMutationArgs(arg1, arg2, arg3);\n  const queryClient = useQueryClient({\n    context: options.context\n  });\n  const [observer] = React.useState(() => new MutationObserver(queryClient, options));\n  React.useEffect(() => {\n    observer.setOptions(options);\n  }, [observer, options]);\n  const result = useSyncExternalStore(React.useCallback(onStoreChange => observer.subscribe(notifyManager.batchCalls(onStoreChange)), [observer]), () => observer.getCurrentResult(), () => observer.getCurrentResult());\n  const mutate = React.useCallback((variables, mutateOptions) => {\n    observer.mutate(variables, mutateOptions).catch(noop);\n  }, [observer]);\n\n  if (result.error && shouldThrowError(observer.options.useErrorBoundary, [result.error])) {\n    throw result.error;\n  }\n\n  return { ...result,\n    mutate,\n    mutateAsync: result.mutate\n  };\n} // eslint-disable-next-line @typescript-eslint/no-empty-function\n\nfunction noop() {}\n\nexport { useMutation };\n//# sourceMappingURL=useMutation.mjs.map\n","import { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { generatePath } from 'react-router-dom'\nimport type { Key } from '../../entities/keys'\nimport { requestJson } from '../../utils/requests'\n  \nconst STUB_API_PATH = '/stub/api/v1'\n\ntype RevertAiEnhancedPackageVersionRequest = {\n  packageId: Key\n  version: Key\n  slug: Key\n  content: string\n}\n\ntype RevertAiEnhancedPackageVersionResponse = {\n  message: string\n}\n\ntype RevertMutationFn = (request: RevertAiEnhancedPackageVersionRequest) => void\n\ntype RevertMutationState = {\n  mutate: RevertMutationFn\n  isReverting: boolean\n}\n\nexport function useRevert(): RevertMutationState {\n  const queryClient = useQueryClient()\n\n  const { mutate, isLoading: isReverting } = useMutation<\n    RevertAiEnhancedPackageVersionResponse,\n    Error,\n    RevertAiEnhancedPackageVersionRequest\n  >({\n    mutationFn: request => revert(request),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['ai-enhanced-document-raw-content'] })\n    },\n  })\n\n  return { mutate, isReverting }\n}\n\nfunction revert(request: RevertAiEnhancedPackageVersionRequest): Promise<RevertAiEnhancedPackageVersionResponse> {\n  const { packageId, version, slug, content } = request\n  const packageKey = encodeURIComponent(packageId)\n  const versionKey = encodeURIComponent(version)\n  const documentKey = encodeURIComponent(slug)\n\n  const endpointPattern = '/packages/:packageId/versions/:versionId/enhancedFiles/:documentId/raw'\n  const endpoint = generatePath(endpointPattern, {\n    packageId: packageKey,\n    versionId: versionKey,\n    documentId: documentKey,\n  })\n  return requestJson<RevertAiEnhancedPackageVersionResponse>(\n    endpoint,\n    {\n      method: 'PUT',\n      body: content,\n    },\n    {\n      basePath: STUB_API_PATH,\n    },\n  )\n}\n","import { editor as Editor, Range } from 'monaco-editor'\nimport type { MutableRefObject } from 'react'\nimport { useEffect, useRef } from 'react'\nimport { useParams } from 'react-router'\nimport { useRevert } from './useRevert'\n\nconst RawDiffTypes = {\n  add: 'add',\n  remove: 'remove',\n  change: 'change',\n}\ntype RawDiffType = typeof RawDiffTypes[keyof typeof RawDiffTypes]\n\nexport function useAddLineControls(\n  editor: MutableRefObject<Editor.IStandaloneDiffEditor | undefined>,\n): void {\n  const { packageId, versionId, documentId } = useParams()\n  const { mutate: revert, isReverting } = useRevert()\n\n  const widgetsRef = useRef<Editor.IGlyphMarginWidget[]>([])\n  const modelIdRef = useRef<string | null>(null)\n  const disposableRef = useRef<{ dispose: () => void } | null>(null)\n\n  useEffect(() => {\n    if (!editor.current) {\n      return\n    }\n\n    const diffEditor = editor.current\n    const modifiedEditor = diffEditor.getModifiedEditor()\n    const model = diffEditor.getModel()\n\n    if (!model) {\n      return\n    }\n\n    const currentModelId = model.modified.uri.toString()\n\n    // Only create widgets if model changed\n    if (modelIdRef.current === currentModelId) {\n      return\n    }\n\n    modelIdRef.current = currentModelId\n\n    // Cleanup previous subscription and widgets\n    if (disposableRef.current) {\n      disposableRef.current.dispose()\n    }\n\n    const currentWidgets = widgetsRef.current\n\n    currentWidgets.forEach((widget) => {\n      modifiedEditor.removeGlyphMarginWidget(widget)\n    })\n\n    widgetsRef.current = []\n\n    // Function to add line controls\n    const addLineControls = (): void => {\n      // Clean up existing widgets before adding new ones\n      widgetsRef.current.forEach((widget) => {\n        modifiedEditor.removeGlyphMarginWidget(widget)\n      })\n\n      const lineChanges = diffEditor.getLineChanges()\n\n      if (!lineChanges) {\n        return\n      }\n\n      const widgets: Editor.IGlyphMarginWidget[] = []\n\n      // Create a glyph margin widget only for lines in changed fragments\n      lineChanges.forEach((change) => {\n        // Get the range of modified lines for this change\n        const {\n          modifiedStartLineNumber,\n          modifiedEndLineNumber,\n        } = change\n\n        const diffType: RawDiffType = detectDiffType(change)\n\n        // Create a button for each line in the changed fragment\n        for (let lineNumber = modifiedStartLineNumber; lineNumber <= modifiedEndLineNumber; lineNumber++) {\n          // Create simple HTML button\n          const button = document.createElement('button')\n          button.textContent = 'â†’'\n          button.style.cssText = 'cursor: pointer; border: none; background: none; font-size: 16px; padding: 0; width: 100%; text-align: center;'\n\n          button.onclick = (e) => {\n            e.preventDefault()\n            e.stopPropagation()\n            const originalValue = diffEditor.getModel()?.original.getValue()\n            const modifiedValue = diffEditor.getModel()?.modified.getValue()\n            if (originalValue && modifiedValue) {\n              const revertedValue = revertChange(originalValue, modifiedValue, change)\n              revert({\n                packageId: packageId ?? '',\n                version: versionId ?? '',\n                slug: documentId ?? '',\n                content: revertedValue,\n              })\n            }\n          }\n\n          let range: Range\n          if (diffType === RawDiffTypes.add) {\n            range = new Range(lineNumber, 1, modifiedEndLineNumber, 1)\n            lineNumber += modifiedEndLineNumber - lineNumber + 1\n          } else {\n            range = new Range(lineNumber, 1, lineNumber, 1)\n          }\n\n          const widget: Editor.IGlyphMarginWidget = {\n            getId: () => `line-control-${lineNumber}`,\n            getDomNode: () => button,\n            getPosition: () => ({\n              lane: Editor.GlyphMarginLane.Right,\n              zIndex: 10,\n              range: range,\n            }),\n          }\n\n          modifiedEditor.addGlyphMarginWidget(widget)\n          widgets.push(widget)\n        }\n      })\n\n      widgetsRef.current = widgets\n    }\n\n    // Try to add controls immediately\n    addLineControls()\n\n    // Subscribe to diff updates to add controls when diff is computed\n    disposableRef.current = diffEditor.onDidUpdateDiff(() => { addLineControls() })\n\n    return () => { disposableRef.current?.dispose() }\n  }, [editor])\n}\n\n/**\n * Receives original and modified values and a change and returns modified value with reverted change\n * @param originalValue Original value\n * @param modifiedValue Modified value\n * @param change MonacoEditor line change\n * @returns Modified value with reverted change\n */\nfunction revertChange(\n  originalValue: string,\n  modifiedValue: string,\n  change: Editor.ILineChange,\n): string {\n  const originalLines = originalValue.split('\\n')\n  const modifiedLines = modifiedValue.split('\\n')\n\n  const diffType: RawDiffType = detectDiffType(change)\n\n  if (diffType === RawDiffTypes.remove) {\n    const pickedOriginalLines = originalLines.slice(change.originalStartLineNumber - 1, change.originalEndLineNumber)\n    const updatedModifiedLines = [...modifiedLines]\n    updatedModifiedLines.splice(change.modifiedStartLineNumber - 1, 0, ...pickedOriginalLines)\n    return updatedModifiedLines.join('\\n')\n  }\n\n  if (diffType === RawDiffTypes.change) {\n    const pickedOriginalLines = originalLines.slice(change.originalStartLineNumber - 1, change.originalEndLineNumber)\n    const updatedModifiedLines = [...modifiedLines]\n    updatedModifiedLines.splice(change.modifiedStartLineNumber - 1, pickedOriginalLines.length, ...pickedOriginalLines)\n    return updatedModifiedLines.join('\\n')\n  }\n\n  if (diffType === RawDiffTypes.add) {\n    const updatedModifiedLines = modifiedLines.filter(\n      (_, index) => index < change.modifiedStartLineNumber - 1 || index > change.modifiedEndLineNumber - 1,\n    )\n    return updatedModifiedLines.join('\\n')\n  }\n\n  return ''\n}\n\n/**\n * Detects diff type from MonacoEditor line change\n * Variants:\n * - change: The line has been changed\n * - add: The line(s) has(ve) been added\n * - remove: The line(s) has(ve) been removed\n * @param change MonacoEditor line change\n * @returns Diff type\n */\nfunction detectDiffType(change: Editor.ILineChange): RawDiffType {\n  const {\n    originalStartLineNumber,\n    originalEndLineNumber,\n    modifiedStartLineNumber,\n    modifiedEndLineNumber,\n  } = change\n\n  const modifiedRange = modifiedEndLineNumber - modifiedStartLineNumber\n  const originalRange = originalEndLineNumber - originalStartLineNumber\n  if (modifiedRange === originalRange) {\n    return RawDiffTypes.change\n  }\n  return modifiedRange > originalRange\n    ? RawDiffTypes.add\n    : RawDiffTypes.remove\n}\n","/**\n * Copyright 2024-2025 NetCracker Technology Corporation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { RefObject } from 'react'\nimport { useEffect, useRef } from 'react'\nimport { editor as Editor } from 'monaco-editor'\nimport { useEffectOnce } from 'react-use'\nimport type { SpecType } from '../../utils/specs'\nimport type { LanguageType } from '../../types/languages'\nimport { LANGUAGE_TYPE_TEXT } from '../../types/languages'\nimport type { SpecItemUri } from '../../utils/specifications'\nimport { findPathLocation } from '../../utils/specifications'\nimport { useAddLineControls } from './useAddLineControls'\n\nexport function useMonacoDiffEditorElement(options: {\n  before: string\n  after: string\n  type: SpecType\n  language?: LanguageType\n  selectedUri?: SpecItemUri\n}): RefObject<HTMLDivElement> {\n  const { before, after, type, language = LANGUAGE_TYPE_TEXT, selectedUri } = options\n\n  const ref = useRef<HTMLDivElement>(null)\n  const editor = useRef<Editor.IStandaloneDiffEditor>()\n\n  useEffectOnce(() => {\n    Editor.defineTheme('custom', {\n      base: 'vs',\n      inherit: true,\n      rules: [],\n      colors: {\n        'editor.background': '#FFFFFF',\n      },\n    })\n\n    editor.current = Editor.createDiffEditor(ref.current!, {\n      minimap: { enabled: true },\n      hover: { above: false },\n      automaticLayout: true,\n      readOnly: true,\n      wordWrap: 'on',\n      glyphMargin: true,\n      theme: 'custom',\n    })\n\n    return () => {\n      try {\n        editor.current?.setModel(null)\n      } catch (_) {\n        // editor might already be disposed; ignore\n      }\n      editor.current?.dispose()\n      // prevent future calls on a disposed instance\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      editor.current = undefined\n    }\n  })\n\n  useEffect(() => {\n    //todo resolve problem with load schema model by filename (like in useSetEditorModel)\n    const originalModel = Editor.createModel(before, language)\n    const modifiedModel = Editor.createModel(after, language)\n\n    editor.current?.setModel({\n      original: originalModel,\n      modified: modifiedModel,\n    })\n\n    return () => {\n      const { current } = editor\n      const currentModel = current?.getModel()\n\n      // Detach only if the editor still uses the models created by this render\n      if (\n        current &&\n        currentModel &&\n        currentModel.original === originalModel &&\n        currentModel.modified === modifiedModel\n      ) {\n        try {\n          current.setModel(null)\n        } catch (_) {\n          // editor may have been disposed concurrently; ignore\n        }\n      }\n\n      originalModel.dispose()\n      modifiedModel.dispose()\n    }\n  }, [editor, before, after, language, type])\n\n  useAddLineControls(editor)\n\n  useEffect(() => {\n    const content = editor.current?.getModel()?.modified.getValue()\n    if (selectedUri && content) {\n      const location = findPathLocation(content, selectedUri)\n      if (location) {\n        const startLine = location?.range.start.line\n        navigateTo(editor.current!, startLine + 1)\n      }\n    }\n  }, [selectedUri])\n\n  return ref\n}\n\nfunction navigateTo(\n  editor: Editor.IStandaloneDiffEditor,\n  lineNumber: number,\n): void {\n  editor.revealLineNearTop(lineNumber, Editor.ScrollType.Smooth)\n  editor.setPosition({ lineNumber: lineNumber, column: 0 })\n  editor.focus()\n}\n","/**\n * Copyright 2024-2025 NetCracker Technology Corporation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'monaco-editor/esm/vs/editor/editor.all.js'\nimport 'monaco-editor/esm/vs/language/json/monaco.contribution'\nimport 'monaco-editor/esm/vs/basic-languages/yaml/yaml.contribution'\nimport 'monaco-editor/esm/vs/basic-languages/markdown/markdown.contribution'\n\nimport type { FC } from 'react'\nimport { memo } from 'react'\nimport { useMonacoDiffEditorElement } from './useMonacoDiffEditorElement'\nimport type { SpecType } from '../../utils/specs'\nimport type { LanguageType } from '../../types/languages'\nimport type { SpecItemUri } from '../../utils/specifications'\n\nexport type MonacoDiffEditorElementProps = {\n  before: string\n  after: string\n  type: SpecType\n  language?: LanguageType\n  selectedUri?: SpecItemUri\n}\n\nconst MonacoDiffEditorElement: FC<MonacoDiffEditorElementProps> = memo<MonacoDiffEditorElementProps>(({\n  before,\n  after,\n  type,\n  language,\n  selectedUri,\n}) => {\n  const element = useMonacoDiffEditorElement({ before, after, type, language, selectedUri })\n\n  return (\n    <div\n      ref={element}\n      style={{ height: '100%' }}\n    />\n  )\n})\n\nexport default MonacoDiffEditorElement\n"],"names":["getDefaultState","MutationObserver","Subscribable","client","options","prevOptions","shallowEqualObjects","_this$currentMutation","action","notifyOptions","variables","state","result","notifyManager","_this$mutateOptions$o","_this$mutateOptions","_this$mutateOptions$o2","_this$mutateOptions2","_this$mutateOptions$o3","_this$mutateOptions3","_this$mutateOptions$o4","_this$mutateOptions4","listener","useMutation","arg1","arg2","arg3","parseMutationArgs","queryClient","useQueryClient","observer","React.useState","React.useEffect","useSyncExternalStore","React.useCallback","onStoreChange","mutate","mutateOptions","noop","shouldThrowError","STUB_API_PATH","useRevert","isReverting","request","revert","packageId","version","slug","content","packageKey","versionKey","documentKey","endpoint","generatePath","requestJson","RawDiffTypes","useAddLineControls","editor","versionId","documentId","useParams","widgetsRef","useRef","modelIdRef","disposableRef","useEffect","diffEditor","modifiedEditor","model","currentModelId","widget","addLineControls","lineChanges","widgets","change","modifiedStartLineNumber","modifiedEndLineNumber","diffType","detectDiffType","lineNumber","button","e","originalValue","_a","modifiedValue","_b","revertedValue","revertChange","range","Range","Editor","originalLines","modifiedLines","pickedOriginalLines","updatedModifiedLines","_","index","originalStartLineNumber","originalEndLineNumber","modifiedRange","originalRange","useMonacoDiffEditorElement","before","after","type","language","LANGUAGE_TYPE_TEXT","selectedUri","ref","useEffectOnce","originalModel","modifiedModel","current","currentModel","location","findPathLocation","startLine","navigateTo","MonacoDiffEditorElement","memo","element","jsx"],"mappings":"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","x_google_ignoreList":[0,1,2]}