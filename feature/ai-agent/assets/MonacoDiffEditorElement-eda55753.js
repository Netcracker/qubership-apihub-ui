import{j as C}from"./createTheme-d4c6d141.js";import{R as D,e as y}from"./toggleHighContrast-5def4e94.js";import{r as p}from"./index-37ba2b57.js";import{f as k,L as j}from"./graphql-samples-79dbe107.js";import{u as F}from"./useEffectOnce-12abbac4.js";import"./emotion-use-insertion-effect-with-fallbacks.browser.esm-9c75dc50.js";import"./iframe-63e5311c.js";import"../sb-preview/runtime.js";import"./_commonjsHelpers-de833af9.js";import"./files-221a97f0.js";import"./apihub-builder.es-a0fb97bd.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./strings-8f296fda.js";import"./dialogTitleClasses-c8d9dbc5.js";import"./clsx.m-6cf3b989.js";import"./ClassNameGenerator-bd600f10.js";import"./useThemeProps-90078124.js";import"./useTheme-0ad13214.js";import"./Modal-9f2c2b11.js";import"./utils-0c060528.js";import"./inheritsLoose-5494d9cc.js";import"./index-4da2af8c.js";import"./TransitionGroupContext-f40e0036.js";import"./useEnhancedEffect-9d60ea74.js";import"./ownerDocument-613eb639.js";import"./ownerWindow-03d1c82d.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-fc00eb8c.js";import"./isHostComponent-73d6e646.js";import"./Paper-dca8f967.js";import"./useId-f6e37502.js";import"./DialogTitle-cd1b99ce.js";import"./Typography-d1555f73.js";import"./extendSxProp-acc1143e.js";import"./DialogContent-fd001b96.js";import"./DialogContentText-f02e7458.js";import"./Button-7fbb2719.js";import"./ButtonBase-1b5192e9.js";import"./emotion-react.browser.esm-f969ea94.js";import"./assertThisInitialized-081f9914.js";import"./createSvgIcon-473ccb66.js";const g={add:"add",remove:"remove",change:"change"};function b(e){const r=p.useRef([]),o=p.useRef(null),d=p.useRef(null);p.useEffect(()=>{if(!e.current)return;const t=e.current,i=t.getModifiedEditor(),s=t.getModel();if(!s)return;const n=s.modified.uri.toString();if(o.current===n)return;o.current=n,d.current&&d.current.dispose(),r.current.forEach(a=>{i.removeGlyphMarginWidget(a)}),r.current=[];const m=()=>{r.current.forEach(l=>{i.removeGlyphMarginWidget(l)});const a=t.getLineChanges();if(!a)return;const c=[];a.forEach(l=>{const{modifiedStartLineNumber:E,modifiedEndLineNumber:v}=l,q=S(l);for(let f=E;f<=v;f++){const L=document.createElement("button");L.textContent="â†’",L.style.cssText="cursor: pointer; border: none; background: none; font-size: 16px; padding: 0; width: 100%; text-align: center;",L.onclick=_=>{var T,w;_.preventDefault(),_.stopPropagation(),console.log("Reverting change:",l);const N=(T=t.getModel())==null?void 0:T.original.getValue(),R=(w=t.getModel())==null?void 0:w.modified.getValue();if(N&&R){const x=G(N,R,l);console.log("Spec after reverting change:",x)}};let h;q===g.add?(h=new D(f,1,v,1),f+=v-f+1):h=new D(f,1,f,1);const M={getId:()=>`line-control-${f}`,getDomNode:()=>L,getPosition:()=>({lane:y.GlyphMarginLane.Right,zIndex:10,range:h})};i.addGlyphMarginWidget(M),c.push(M)}}),r.current=c};return m(),d.current=t.onDidUpdateDiff(()=>{m()}),()=>{var a;(a=d.current)==null||a.dispose()}},[e])}function G(e,r,o){const d=e.split(`
`),t=r.split(`
`),i=S(o);if(i===g.change||i===g.remove){const s=d.slice(o.originalStartLineNumber-1,o.originalEndLineNumber),n=[...t];return n.splice(o.modifiedStartLineNumber-1,0,...s),n.join(`
`)}return i===g.add?t.filter((n,u)=>u<o.modifiedStartLineNumber-1||u>o.modifiedEndLineNumber-1).join(`
`):""}function S(e){const{originalStartLineNumber:r,originalEndLineNumber:o,modifiedStartLineNumber:d,modifiedEndLineNumber:t}=e,i=t-d,s=o-r;return i===s?g.change:i>s?g.add:g.remove}try{b.displayName="useAddLineControls",b.__docgenInfo={description:"",displayName:"useAddLineControls",props:{}}}catch{}function I(e){const{before:r,after:o,type:d,language:t=j,selectedUri:i}=e,s=p.useRef(null),n=p.useRef();return F(()=>(y.defineTheme("custom",{base:"vs",inherit:!0,rules:[],colors:{"editor.background":"#FFFFFF"}}),n.current=y.createDiffEditor(s.current,{minimap:{enabled:!0},hover:{above:!1},automaticLayout:!0,readOnly:!0,wordWrap:"on",glyphMargin:!0,theme:"custom"}),()=>{var u;(u=n.current)==null||u.dispose()})),p.useEffect(()=>{var u;return(u=n.current)==null||u.setModel({original:y.createModel(r,t),modified:y.createModel(o,t)}),()=>{var m,a,c,l,E,v;(c=(a=(m=n.current)==null?void 0:m.getModel())==null?void 0:a.original)==null||c.dispose(),(v=(E=(l=n.current)==null?void 0:l.getModel())==null?void 0:E.modified)==null||v.dispose()}},[n,r,o,t,d]),b(n),p.useEffect(()=>{var m,a;const u=(a=(m=n.current)==null?void 0:m.getModel())==null?void 0:a.modified.getValue();if(i&&u){const c=k(u,i);if(c){const l=c==null?void 0:c.range.start.line;W(n.current,l+1)}}},[i]),s}function W(e,r){e.revealLineNearTop(r,y.ScrollType.Smooth),e.setPosition({lineNumber:r,column:0}),e.focus()}const V=p.memo(({before:e,after:r,type:o,language:d,selectedUri:t})=>{const i=I({before:e,after:r,type:o,language:d,selectedUri:t});return C("div",{ref:i,style:{height:"100%"}})});try{V.displayName="MonacoDiffEditorElement",V.__docgenInfo={description:"",displayName:"MonacoDiffEditorElement",props:{before:{defaultValue:null,description:"",name:"before",required:!0,type:{name:"string"}},after:{defaultValue:null,description:"",name:"after",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"graphql"'},{value:'"openapi-3-1"'},{value:'"openapi-3-0"'},{value:'"openapi-2-0"'},{value:'"openapi"'},{value:'"asyncapi-2"'},{value:'"json-schema"'},{value:'"markdown"'},{value:'"unknown"'},{value:'"graphql-schema"'},{value:'"graphapi"'},{value:'"introspection"'},{value:'"protobuf-3"'}]}},language:{defaultValue:null,description:"",name:"language",required:!1,type:{name:"enum",value:[{value:'"text"'},{value:'"graphql"'},{value:'"markdown"'},{value:'"yaml"'},{value:'"json"'},{value:'"proto"'}]}},selectedUri:{defaultValue:null,description:"",name:"selectedUri",required:!1,type:{name:"`/${string}`"}}}}}catch{}export{V as default};
//# sourceMappingURL=MonacoDiffEditorElement-eda55753.js.map
