import{j as e,a as p}from"./createTheme-c79a82be.js";import{r}from"./index-76fb7be0.js";import{D as te,u as oe,a as ae,b as re,f as R,g as ne,c as ie}from"./useResizeObserver-f188b94d.js";import{T as b}from"./TextWithOverflowTooltip-6aa2276f.js";import{C as se}from"./ColumnDelimiter-73e9444f.js";import{u as le}from"./useIntersectionObserver-4badedcf.js";import{I as de}from"./InfoContextIcon-3766eb7f.js";import{i as B}from"./arrays-4b61f5c5.js";import{D as ce}from"./constants-ba72550f.js";import{c as me}from"./components-38941026.js";import{D as V}from"./DownloadIcon-2662f327.js";import{a as pe}from"./MenuButton-ce8e54ab.js";import{B as ue}from"./ButtonWithHint-0ce37f1e.js";import{F as ge}from"./FormattedDate-442ffd66.js";import{P as he}from"./PrincipalView-c283186e.js";import{B as F}from"./Box-5be9d6da.js";import{T as S}from"./Typography-3dfb61d7.js";import{T as z}from"./Tooltip-c1c77c1b.js";import{T as fe,a as ye,b as we}from"./TableHead-7ab2bcd7.js";import{T as Ne,a as y,b as l}from"./TableRow-e0112d53.js";import{S as c}from"./Skeleton-793a8760.js";import{P as Se,C as xe}from"./Placeholder-474ee0b6.js";import{M as Te}from"./MenuItem-8e01baec.js";import"./emotion-use-insertion-effect-with-fallbacks.browser.esm-aa53f5e3.js";import"./_commonjsHelpers-de833af9.js";import"./debounce-517eeb3c.js";import"./OverflowTooltip-4f8483c3.js";import"./jsx-runtime_commonjs-proxy-9a1bbb33.js";import"./createSvgIcon-b791e64c.js";import"./clsx.m-e92c351d.js";import"./index-71e0858c.js";import"./useThemeProps-aa843650.js";import"./createChainedFunction-0bab83cf.js";import"./ownerDocument-613eb639.js";import"./ownerWindow-03d1c82d.js";import"./TransitionGroupContext-48398eec.js";import"./isMuiElement-bce4c331.js";import"./useId-a47493a3.js";import"./useControlled-3e5b2082.js";import"./Button-d8b56272.js";import"./ButtonBase-05fdfea8.js";import"./emotion-react.browser.esm-b0f55332.js";import"./hoist-non-react-statics.cjs-b1c88361.js";import"./assertThisInitialized-081f9914.js";import"./inheritsLoose-5494d9cc.js";import"./Menu-b4cdd8f7.js";import"./index-891d46e9.js";import"./useTheme-11ba6946.js";import"./Modal-89faf1a9.js";import"./utils-a355cc51.js";import"./index-d3ea75b5.js";import"./Portal-18509f2e.js";import"./isHostComponent-73d6e646.js";import"./Paper-c822a8c8.js";import"./Grow-a4fcaa6b.js";import"./List-d5d9a26a.js";import"./ListContext-e9aee161.js";import"./CircularProgress-81e0b845.js";import"./LoadingButton-750b14d7.js";import"./IconButton-e8de8077.js";import"./principals-9d3b18d7.js";import"./UserView-c1b5c0a1.js";import"./UserAvatar-9e71b80f.js";import"./strings-8f296fda.js";import"./extendSxProp-aea61bfb.js";import"./Popper-85045249.js";import"./dividerClasses-7f0a34f7.js";import"./listItemTextClasses-0a065631.js";import"./listItemIconClasses-035ccd93.js";const w=r.memo(({data:n,downloadOptions:t,downloadSecurityReport:i,fetchNextPage:d,isFetchingNextPage:s,hasNextPage:m,isLoading:N})=>{const[K,Y]=r.useState(te),[Z,G]=r.useState(),[,J]=r.useState(),T=r.useRef(null);oe(T,Y);const u=ae({containerWidth:K,columnModels:De,columnSizingInfo:Z,defaultMinColumnSize:150}),D=r.useRef(null);le(D,s,m,d);const C=r.useMemo(()=>[{id:k,header:"Date",cell:({row:{original:{createdAt:o}}})=>e(ge,{value:o})},{id:$,header:"Created By",cell:({row:{original:{createdBy:o}}})=>e(he,{value:o})},{id:q,header:"Status",cell:({row:{original:{status:o,details:a}}})=>p(F,{display:"flex",children:[e(S,{fontSize:"13px",children:o}),o!==Re&&a&&e(z,{title:a,children:e(de,{fontSize:"extra-small",sx:{ml:.5}})})]})},{id:H,header:"Total Number of Services",cell:({row:{original:{servicesTotal:o}}})=>e(b,{tooltipText:o,children:e(S,{variant:"inherit",children:o})})},{id:W,header:"Number of Processed Services",cell:({row:{original:{servicesProcessed:o}}})=>e(b,{tooltipText:o,children:e(S,{variant:"inherit",children:o})})},{id:j,header:"",cell:({row:{original:{processId:o}}})=>e(be,{processId:o,onDownloadReport:i,downloadOptions:t})}],[t,i]),{getHeaderGroups:Q,getRowModel:X,setColumnSizing:_}=re({data:n,columns:C,columnResizeMode:"onChange",getCoreRowModel:ne(),getExpandedRowModel:ie(),onColumnSizingChange:J,onColumnSizingInfoChange:G});return r.useEffect(()=>_(u),[_,u]),p(fe,{ref:T,children:[p(Ne,{children:[e(ye,{children:Q().map(o=>e(y,{children:o.headers.map((a,ee)=>p(l,{align:"left",width:u?u[a.id]:a.getSize(),sx:{"&:hover":{borderRight:"2px solid rgba(224, 224, 224, 1)"}},children:[R(a.column.columnDef.header,a.getContext()),ee!==o.headers.length-1&&e(se,{header:a,resizable:!0})]},a.id))},o.id))}),p(we,{children:[X().rows.map(o=>e(y,{children:o.getVisibleCells().map(a=>e(l,{"data-testid":`Cell-${a.column.id}`,children:R(a.column.columnDef.cell,a.getContext())},a.column.id))})),N&&e(Ce,{}),e(y,{children:m&&C.map(o=>e(l,{ref:D,children:e(c,{variant:"text"})},o.id))})]})]}),B(n)&&!N?e(Se,{sx:{width:"inherit"},invisible:N,area:xe,message:"No reports",testId:"NoReportsPlaceholder"}):null]})}),k="date",$="created-by",q="status",H="total-number-of-services",W="number-of-processed-services",j="actions",De=[{name:k,width:181},{name:$,width:415},{name:q,width:169},{name:H,width:195},{name:W,width:195},{name:j,width:43}],Ce=r.memo(()=>me(e(_e,{}),ce)),_e=r.memo(()=>p(y,{children:[e(l,{children:e(c,{variant:"rectangular",width:"70%"})}),e(l,{children:e(c,{variant:"rectangular",width:"35%"})}),e(l,{children:e(c,{variant:"rectangular",width:"50%"})}),e(l,{children:e(c,{variant:"rectangular",width:"20%"})}),e(l,{children:e(c,{variant:"rectangular",width:"20%"})}),e(l,{children:e(c,{variant:"rectangular",width:"50%"})})]})),Re="running",be=r.memo(({processId:n,onDownloadReport:t,downloadOptions:i})=>{const d=r.useCallback(m=>t(n,m),[t,n]),s=r.useCallback(()=>t(n),[t,n]);return i?e(Pe,{sx:{visibility:"hidden"},className:"hoverable",options:i,onClick:d}):e(ue,{"area-label":"edit",hint:"Download report",size:"small",sx:{visibility:"hidden",height:"20px"},className:"hoverable",startIcon:e(V,{color:"#626D82"}),onClick:s,testId:"DownloadReportButton"})}),Pe=r.memo(({options:n,onClick:t,sx:i,className:d})=>e(z,{title:"Download",children:e(F,{sx:{display:"inline"},children:e(pe,{sx:i,icon:e(V,{color:"#626D82"}),alignItems:"center",className:d,"data-testid":"DownloadMenuButton",children:n.map(({value:s,text:m})=>e(Te,{value:s,onClick:()=>t(s),"data-testid":`Option-${s}`,children:m},`download-option-${s}`))})})}));try{w.displayName="SecurityReportsTable",w.__docgenInfo={description:"",displayName:"SecurityReportsTable",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"SecurityReports"}},downloadOptions:{defaultValue:null,description:"",name:"downloadOptions",required:!1,type:{name:"ReportDownloadOption[]"}},downloadSecurityReport:{defaultValue:null,description:"",name:"downloadSecurityReport",required:!0,type:{name:"(processKey: string, value?: DownloadType | undefined) => void"}},fetchNextPage:{defaultValue:null,description:"",name:"fetchNextPage",required:!0,type:{name:"() => Promise<number>"}},isFetchingNextPage:{defaultValue:null,description:"",name:"isFetchingNextPage",required:!0,type:{name:"boolean"}},hasNextPage:{defaultValue:null,description:"",name:"hasNextPage",required:!0,type:{name:"HasNextPage"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}}}}}catch{}const ve=Array.from({length:30},(n,t)=>({processId:`long-process-name-number-${t}`,createdAt:"2021-09-01T12:00:00Z",createdBy:{type:"user",id:`id-${t+1}`,avatarUrl:"https://via.placeholder.com/150",name:`VeryVeryVeryVeryVeryVeryLongUserNameThatExceedsTheUsualLength ${t}`},status:"complete",errorMessage:void 0,servicesProcessed:2e8+t,servicesTotal:1e7+t})),x=Array.from({length:20},(n,t)=>({processId:`process${t+Math.random()*100}`,createdAt:"2021-09-01T12:00:00Z",createdBy:{type:"user",id:`id-${t+Math.random()*10}`,avatarUrl:"https://via.placeholder.com/150",name:`User ${t+ +Math.round(Math.random()*100)}`},status:t%2===0?"complete":"error",errorMessage:t%2===0?void 0:"Error occurred",servicesProcessed:t*5,servicesTotal:500})),{useArgs:Ee}=__STORYBOOK_MODULE_PREVIEW_API__,jt={title:"Security Reports Table",component:w},g={name:"Empty Data",args:{data:[],downloadSecurityReport:()=>console.log("Mock download function executed"),fetchNextPage:()=>Promise.resolve(0),isFetchingNextPage:!1,hasNextPage:!1,isLoading:!1}},h={name:"Long Data Names",args:{data:ve,downloadSecurityReport:()=>console.log("Mock download function executed"),fetchNextPage:()=>Promise.resolve(0),isFetchingNextPage:!1,hasNextPage:!1,isLoading:!1,downloadOptions:[{value:"download-report",text:"Download Option 1"},{value:"download-report",text:"Download Option 2"}]}},f={name:"Infinity Data",args:{data:x,downloadSecurityReport:()=>console.log("Mock download function executed"),isFetchingNextPage:!1,hasNextPage:!0,isLoading:!1},render:function(t){const[{data:i},d]=Ee();function s(){return d({data:B(i)?x:[...i,...x]}),Promise.resolve(1)}return e(w,{...t,fetchNextPage:s,data:i})}};var P,v,E;g.parameters={...g.parameters,docs:{...(P=g.parameters)==null?void 0:P.docs,source:{originalSource:`{
  name: 'Empty Data',
  args: {
    data: [],
    downloadSecurityReport: () => console.log('Mock download function executed'),
    fetchNextPage: () => Promise.resolve(0),
    isFetchingNextPage: false,
    hasNextPage: false,
    isLoading: false
  }
}`,...(E=(v=g.parameters)==null?void 0:v.docs)==null?void 0:E.source}}};var M,O,I;h.parameters={...h.parameters,docs:{...(M=h.parameters)==null?void 0:M.docs,source:{originalSource:`{
  name: 'Long Data Names',
  args: {
    data: longNameTableData,
    downloadSecurityReport: () => console.log('Mock download function executed'),
    fetchNextPage: () => Promise.resolve(0),
    isFetchingNextPage: false,
    hasNextPage: false,
    isLoading: false,
    downloadOptions: [{
      value: 'download-report',
      text: 'Download Option 1'
    }, {
      value: 'download-report',
      text: 'Download Option 2'
    }]
  }
}`,...(I=(O=h.parameters)==null?void 0:O.docs)==null?void 0:I.source}}};var L,A,U;f.parameters={...f.parameters,docs:{...(L=f.parameters)==null?void 0:L.docs,source:{originalSource:`{
  name: 'Infinity Data',
  args: {
    data: fullTableData,
    downloadSecurityReport: () => console.log('Mock download function executed'),
    isFetchingNextPage: false,
    hasNextPage: true,
    isLoading: false
  },
  render: function Render(args) {
    const [{
      data
    }, updateArgs] = useArgs();
    function onFetchNextPage(): Promise<number> {
      updateArgs({
        data: isEmpty(data) ? fullTableData : [...data, ...fullTableData]
      });
      return Promise.resolve(1);
    }
    return <SecurityReportsTable {...args} fetchNextPage={onFetchNextPage} data={data} />;
  }
}`,...(U=(A=f.parameters)==null?void 0:A.docs)==null?void 0:U.source}}};const Kt=["EmptyStory","LongDataNamesStory","InfinityDataStory"];export{g as EmptyStory,f as InfinityDataStory,h as LongDataNamesStory,Kt as __namedExportsOrder,jt as default};
//# sourceMappingURL=SecurityReportsTable.stories-8b46ddda.js.map
